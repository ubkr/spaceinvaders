<!DOCTYPE html>
<html>
<head>
<title>Space Invaders</title>
<style>
  body {
    background-color: #000;
    color: #fff;
    font-family: 'Courier New', monospace;
    text-align: center;
    margin: 0;
    overflow: hidden;
    background: linear-gradient(to bottom, #000000, #111);
  }
  
  .stars {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    animation: twinkling 2s infinite;
  }
  
  @keyframes twinkling {
    0% { opacity: 0.5; }
    50% { opacity: 1; }
    100% { opacity: 0.5; }
  }
  
  h1 {
    font-size: 2.5em;
    text-transform: uppercase;
    letter-spacing: 3px;
    margin: 10px;
    text-shadow: 0 0 10px #0ff,
                 0 0 20px #0ff,
                 0 0 30px #0ff;
    animation: glow 1.5s ease-in-out infinite alternate;
  }
  
  @keyframes glow {
    from { text-shadow: 0 0 5px #0ff, 0 0 10px #0ff, 0 0 15px #0ff; }
    to { text-shadow: 0 0 10px #0ff, 0 0 20px #0ff, 0 0 30px #0ff; }
  }
  
  canvas {
    border: 2px solid #0ff;
    border-radius: 5px;
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
  }
  
  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    font-size: 20px;
    color: #0ff;
    text-shadow: 0 0 5px #0ff;
  }

  #lives {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    color: #f00;
    text-shadow: 0 0 5px #f00;
  }

  #game-over {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    transition: all 0.5s ease;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
  }

  #game-over .main-text {
    font-size: 48px;
    color: #f00;
    text-shadow: 0 0 20px #f00;
  }

  #game-over .restart-text {
    font-size: 24px;
    color: #0ff;
    text-shadow: 0 0 10px #0ff;
    opacity: 0.8;
    animation: blink 1.5s ease-in-out infinite;
  }

  #game-over.show {
    transform: translate(-50%, -50%) scale(1);
    opacity: 1;
  }

  @keyframes blink {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 1; }
  }

  @keyframes pulse {
    0% { transform: translate(-50%, -50%) scale(1); }
    50% { transform: translate(-50%, -50%) scale(1.1); }
    100% { transform: translate(-50%, -50%) scale(1); }
  }

  #settings-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background: rgba(0, 255, 255, 0.2);
    border: 2px solid #0ff;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }

  #settings-button:hover {
    background: rgba(0, 255, 255, 0.4);
    transform: rotate(90deg);
  }

  #settings-panel {
    position: fixed;
    bottom: 70px;
    right: 20px;
    width: 250px;
    background: rgba(0, 0, 0, 0.9);
    border: 2px solid #0ff;
    border-radius: 10px;
    padding: 15px;
    display: none;
    z-index: 1000;
  }

  .settings-group {
    margin-bottom: 15px;
  }

  .settings-group label {
    display: block;
    margin-bottom: 5px;
    color: #0ff;
    font-size: 14px;
  }

  .settings-group input[type="range"] {
    width: 100%;
    background: #000;
    height: 5px;
    border-radius: 5px;
    outline: none;
    -webkit-appearance: none;
    appearance: none;
    appearance: none;
  }

  .settings-group input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 15px;
    height: 15px;
    background: #0ff;
    border-radius: 50%;
    cursor: pointer;
  }

  .value-display {
    color: #0ff;
    font-size: 12px;
    text-align: right;
    margin-top: 5px;
  }
</style>
</head>
<body>
  <div class="stars" id="stars"></div>
  <h1>Space Invaders</h1>
  <canvas id="gameCanvas" width="480" height="320"></canvas>
  <div id="game-over">
    <div class="main-text">GAME OVER</div>
    <div class="restart-text">Press ENTER to restart</div>
  </div>
  <div id="settings-button">⚙️</div>
  <div id="settings-panel">
    <div class="settings-group">
      <label for="player-speed">Player Speed</label>
      <input type="range" id="player-speed" min="1" max="15" value="5">
      <div class="value-display">Current: 5</div>
    </div>
    <div class="settings-group">
      <label for="bomb-frequency">Bomb Frequency (Hz)</label>
      <input type="range" id="bomb-frequency" min="0.1" max="10" step="0.1" value="0.5">
      <div class="value-display">Current: 0.5 Hz</div>
    </div>
  </div>

  <script>
    // Settings Panel
    const settingsButton = document.getElementById('settings-button');
    const settingsPanel = document.getElementById('settings-panel');
    const playerSpeedInput = document.getElementById('player-speed');
    const bombFrequencyInput = document.getElementById('bomb-frequency');
    const playerSpeedDisplay = playerSpeedInput.nextElementSibling;
    const bombFrequencyDisplay = bombFrequencyInput.nextElementSibling;
    const gameOverScreen = document.getElementById('game-over');

    // Bomb timing variables
    let lastBombTime = 0;
    let bombInterval = 2000; // Start at 0.5 Hz (2000ms)

    settingsButton.addEventListener('click', (e) => {
      e.stopPropagation();
      settingsPanel.style.display = settingsPanel.style.display === 'none' ? 'block' : 'none';
    });

    document.addEventListener('click', (e) => {
      if (!settingsPanel.contains(e.target) && e.target !== settingsButton) {
        settingsPanel.style.display = 'none';
      }
    });

    playerSpeedInput.addEventListener('input', (e) => {
      const newSpeed = parseInt(e.target.value);
      playerSpeedDisplay.textContent = `Current: ${newSpeed}`;
      playerSpeed = newSpeed;
    });

    bombFrequencyInput.addEventListener('input', (e) => {
      const newFreq = parseFloat(e.target.value);
      bombFrequencyDisplay.textContent = `Current: ${newFreq.toFixed(1)} Hz`;
      bombInterval = 1000 / newFreq; // Convert Hz to milliseconds
    });

    // Create stars
    function createStars() {
      const stars = document.getElementById('stars');
      for (let i = 0; i < 100; i++) {
        const star = document.createElement('div');
        star.style.position = 'absolute';
        star.style.width = '2px';
        star.style.height = '2px';
        star.style.background = '#fff';
        star.style.left = Math.random() * 100 + '%';
        star.style.top = Math.random() * 100 + '%';
        star.style.opacity = Math.random();
        stars.appendChild(star);
      }
    }
    createStars();

    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // Game State
    let gameActive = true;
    let lives = 3;

    // Player
    let playerX = canvas.width / 2;
    let playerSpeed = 5;
    const playerWidth = 30;
    const playerHeight = 20;

    // Bullets
    const bullets = [];
    const bulletSpeed = 7;
    const bulletEffects = [];
// Invader Bombs
const bombs = [];
const bombSpeed = 3;


    // Invaders
    const invaders = [];
    const invaderRowCount = 3;
    const invaderColumnCount = 5;
    const invaderWidth = 30;
    const invaderHeight = 20;
    const invaderPadding = 10;
    const invaderOffsetTop = 30;
    const invaderOffsetLeft = 30;
    let invaderDirection = 1;

    // Score
    let score = 0;

    // Explosions
    const explosions = [];

    function initializeInvaders() {
      for (let c = 0; c < invaderColumnCount; c++) {
        invaders[c] = [];
        for (let r = 0; r < invaderRowCount; r++) {
          invaders[c][r] = {
            x: (c * (invaderWidth + invaderPadding)) + invaderOffsetLeft,
            y: (r * (invaderHeight + invaderPadding)) + invaderOffsetTop,
            status: 1
          };
        }
      }
    }

    initializeInvaders();

    function drawLives() {
      ctx.font = "20px 'Courier New'";
      ctx.fillStyle = "#f00";
      ctx.shadowColor = "#f00";
      ctx.shadowBlur = 10;
      ctx.fillText("LIVES: " + "❤️".repeat(lives), canvas.width - 150, 20);
      ctx.shadowBlur = 0;
    }

    // Draw Player with gradient
    function drawPlayer() {
      ctx.save();
      const gradient = ctx.createLinearGradient(
        playerX - playerWidth / 2,
        canvas.height - playerHeight - 10,
        playerX + playerWidth / 2,
        canvas.height - 10
      );
      gradient.addColorStop(0, '#0f0');
      gradient.addColorStop(1, '#0ff');
      
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.moveTo(playerX, canvas.height - playerHeight - 10);
      ctx.lineTo(playerX - playerWidth / 2, canvas.height - 10);
      ctx.lineTo(playerX + playerWidth / 2, canvas.height - 10);
      ctx.closePath();
      ctx.fill();
      
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 1;
      ctx.stroke();
      ctx.restore();
    }

    // Draw Bullets with effects
    function drawBullets() {
      ctx.save();
      for (let i = 0; i < bullets.length; i++) {
        const gradient = ctx.createLinearGradient(
          bullets[i].x, bullets[i].y,
          bullets[i].x, bullets[i].y + 10
        );
        gradient.addColorStop(0, '#fff');
        gradient.addColorStop(1, '#0ff');
        
        ctx.fillStyle = gradient;
        ctx.fillRect(bullets[i].x - 1.5, bullets[i].y, 3, 10);
        
        // Add bullet trail effect
        bulletEffects.push({
          x: bullets[i].x,
          y: bullets[i].y + 10,
          alpha: 1
        });
      }
      ctx.restore();
    }

    // Draw Invader Bombs
    function drawBombs() {
      ctx.save();
      for (const bomb of bombs) {
        const gradient = ctx.createLinearGradient(
          bomb.x, bomb.y,
          bomb.x, bomb.y + 10
        );
        gradient.addColorStop(0, '#f00');
        gradient.addColorStop(1, '#ff0');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.moveTo(bomb.x, bomb.y);
        ctx.lineTo(bomb.x - 3, bomb.y + 6);
        ctx.lineTo(bomb.x + 3, bomb.y + 6);
        ctx.closePath();
        ctx.fill();
        
        // Add trail effect
        bulletEffects.push({
          x: bomb.x,
          y: bomb.y - 5,
          alpha: 0.7
        });
      }
      ctx.restore();
    }

    // Draw bullet effects
    function drawBulletEffects() {
      for (let i = bulletEffects.length - 1; i >= 0; i--) {
        const effect = bulletEffects[i];
        ctx.save();
        ctx.globalAlpha = effect.alpha;
        ctx.fillStyle = '#0ff';
        ctx.fillRect(effect.x - 1, effect.y, 2, 2);
        ctx.restore();
        
        effect.alpha -= 0.1;
        effect.y += 2;
        
        if (effect.alpha <= 0) {
          bulletEffects.splice(i, 1);
        }
      }
    }

    // Draw Invaders with gradient
    function drawInvaders() {
      for (let c = 0; c < invaderColumnCount; c++) {
        for (let r = 0; r < invaderRowCount; r++) {
          if (invaders[c][r].status === 1) {
            const x = invaders[c][r].x;
            const y = invaders[c][r].y;
            
            ctx.save();
            const gradient = ctx.createLinearGradient(x, y, x, y + invaderHeight);
            gradient.addColorStop(0, '#f00');
            gradient.addColorStop(1, '#f0f');
            ctx.fillStyle = gradient;
            
            // Draw invader shape
            ctx.beginPath();
            ctx.moveTo(x + invaderWidth/2, y);
            ctx.lineTo(x, y + invaderHeight);
            ctx.lineTo(x + invaderWidth, y + invaderHeight);
            ctx.closePath();
            ctx.fill();
            
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 1;
            ctx.stroke();
            ctx.restore();

            // Check if it's time to drop a bomb based on frequency
            const currentTime = Date.now();
            if (gameActive && currentTime - lastBombTime >= bombInterval) {
              // Pick a random active invader to drop the bomb
              const activeInvaders = [];
              for (let col = 0; col < invaderColumnCount; col++) {
                for (let row = 0; row < invaderRowCount; row++) {
                  if (invaders[col][row].status === 1) {
                    activeInvaders.push(invaders[col][row]);
                  }
                }
              }
              if (activeInvaders.length > 0) {
                const bomber = activeInvaders[Math.floor(Math.random() * activeInvaders.length)];
                bombs.push({
                  x: bomber.x + invaderWidth/2,
                  y: bomber.y + invaderHeight
                });
                lastBombTime = currentTime;
              }
            }
          }
        }
      }
    }

    // Draw explosions
    function drawExplosions() {
      for (let i = explosions.length - 1; i >= 0; i--) {
        const explosion = explosions[i];
        ctx.save();
        ctx.globalAlpha = explosion.alpha;
        ctx.beginPath();
        ctx.arc(explosion.x, explosion.y, explosion.radius, 0, Math.PI * 2);
        ctx.fillStyle = explosion.color;
        ctx.fill();
        ctx.restore();
        
        explosion.radius += 0.5;
        explosion.alpha -= 0.05;
        
        if (explosion.alpha <= 0) {
          explosions.splice(i, 1);
        }
      }
    }

    function updateBullets() {
      for (let i = 0; i < bullets.length; i++) {
        bullets[i].y -= bulletSpeed;
        if (bullets[i].y < 0) {
          bullets.splice(i, 1);
          i--;
        }
      }
    }

    function updateBombs() {
      for (let i = bombs.length - 1; i >= 0; i--) {
        bombs[i].y += bombSpeed;
        
        // Check for collision with player
        const bomb = bombs[i];
        if (bomb.y + 6 > canvas.height - playerHeight - 10 &&
            bomb.x > playerX - playerWidth/2 &&
            bomb.x < playerX + playerWidth/2) {
          // Player hit!
          lives--;
          bombs.splice(i, 1);
          
          // Add explosion effect
          explosions.push({
            x: playerX,
            y: canvas.height - playerHeight - 5,
            radius: 10,
            alpha: 1,
            color: '#f00'
          });

          if (lives <= 0) {
            gameActive = false;
            gameOverScreen.classList.add('show');
          }
          continue;
        }

        // Remove bombs that go off screen
        if (bomb.y > canvas.height) {
          bombs.splice(i, 1);
        }
      }
    }

    function updateInvaders() {
      for (let c = 0; c < invaderColumnCount; c++) {
        for (let r = 0; r < invaderRowCount; r++) {
          if (invaders[c][r].status === 1) {
            invaders[c][r].x += invaderDirection;
          }
        }
      }

      let edgeReached = false;
      for (let c = 0; c < invaderColumnCount; c++) {
        for (let r = 0; r < invaderRowCount; r++) {
          if (invaders[c][r].status === 1) {
            if (invaders[c][r].x <= 0 || invaders[c][r].x + invaderWidth >= canvas.width) {
              edgeReached = true;
              break;
            }
          }
        }
        if (edgeReached) break;
      }

      if (edgeReached) {
        invaderDirection *= -1;
        for (let c = 0; c < invaderColumnCount; c++) {
          for (let r = 0; r < invaderRowCount; r++) {
            if (invaders[c][r].status === 1) {
              invaders[c][r].y += invaderHeight / 2;
            }
          }
        }
      }
    }

    function collisionDetection() {
      for (let c = 0; c < invaderColumnCount; c++) {
        for (let r = 0; r < invaderRowCount; r++) {
          const invader = invaders[c][r];
          if (invader.status === 1) {
            for (let i = 0; i < bullets.length; i++) {
              const bullet = bullets[i];
              if (bullet.x > invader.x && bullet.x < invader.x + invaderWidth &&
                  bullet.y > invader.y && bullet.y < invader.y + invaderHeight) {
                invader.status = 0;
                bullets.splice(i, 1);
                i--;
                score += 10;
                
                // Add explosion effect
                explosions.push({
                  x: invader.x + invaderWidth/2,
                  y: invader.y + invaderHeight/2,
                  radius: 5,
                  alpha: 1,
                  color: '#f0f'
                });
                break;
              }
            }
          }
        }
      }
    }

    function drawScore() {
      ctx.font = "20px 'Courier New'";
      ctx.fillStyle = "#0ff";
      ctx.shadowColor = "#0ff";
      ctx.shadowBlur = 10;
      ctx.fillText("SCORE: " + score, 8, 20);
      ctx.shadowBlur = 0;
    }

    function gameLoop() {
      if (!gameActive) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      drawPlayer();
      drawInvaders();
      drawBullets();
      drawBombs();
      drawBulletEffects();
      drawExplosions();
      drawScore();
      drawLives();

      updateInvaders();
      updateBullets();
      updateBombs();
      collisionDetection();

      requestAnimationFrame(gameLoop);
    }

    gameLoop();

    document.addEventListener("keydown", function(event) {
      if (event.key === "Enter" && !gameActive) {
        // Restart game
        gameActive = true;
        lives = 3;
        score = 0;
        bombs.length = 0;
        bullets.length = 0;
        explosions.length = 0;
        initializeInvaders();
        gameOverScreen.classList.remove('show');
        gameLoop();
        return;
      }

      if (!gameActive) return;

      if (event.key === "ArrowLeft") {
        playerX -= playerSpeed;
        if (playerX < playerWidth / 2) {
          playerX = playerWidth / 2;
        }
      } else if (event.key === "ArrowRight") {
        playerX += playerSpeed;
        if (playerX > canvas.width - playerWidth / 2) {
          playerX = canvas.width - playerWidth / 2;
        }
      } else if (event.key === " ") {
        bullets.push({ x: playerX, y: canvas.height - playerHeight - 10 });
      }
    });
  </script>
</body>
</html>
